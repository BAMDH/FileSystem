
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <title>Mi WebDrive</title>
    <link rel="stylesheet" th:href="@{/css/drive.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

<!-- Barra superior -->
<header class="header">
    <h1>Mi WebDrive</h1>
    <div class="user-info">
        <span th:text="${usuario}">Usuario</span>
        <button onclick="logout()">Salir</button>
    </div>
</header>

<!-- Contenedor general -->
<div class="container">

    <!-- Barra lateral -->
    <aside class="sidebar">
        <button onclick="irAtras()" class="btn-back">
        <i class="fas fa-arrow-left"></i> Volver
    </button>
        <button onclick="crearArchivo()">+ Archivo</button>
        <button onclick="crearDirectorio()">+ Carpeta</button>
        <button onclick="subirArchivo()">Subir</button>
        <hr>
        <nav>
            <ul>
                <li onclick="cambiarVista('mis_archivos')"><i class="fa fa-folder"></i> Mis archivos</li>
                <li onclick="cambiarVista('compartidos')"><i class="fa fa-users"></i> Compartidos conmigo</li>
                <li onclick="cambiarVista('papelera')"><i class="fa fa-trash"></i> Papelera</li>
            </ul>
        </nav>
    </aside>

    <!-- Vista de archivos -->
    <main class="file-view">
        <div class="path-bar">
            Ruta: <span th:text="${rutaActual}">/</span>
        </div>

        <!-- SecciÃ³n de archivos actualizada -->
    <div class="grid">
        <!-- Carpetas -->
        <div th:each="carpeta : ${carpetas}" 
             class="item folder" 
             th:attr="data-carpeta=${carpeta.name}"
             onclick="abrirCarpeta(this.getAttribute('data-carpeta'))">
            <i class="fa fa-folder fa-3x"></i>
            <div class="item-name" th:text="${carpeta.name}">Carpeta</div>
        </div>
        <!-- Archivos -->
        <div th:each="archivo : ${archivos}" 
            class="item file" 
            th:attr="data-archivo=${archivo.name + '.' + archivo.extension}"
            onclick="verArchivo(this.getAttribute('data-archivo'))">
           <i class="fa fa-file-alt fa-3x"></i>
           <div class="item-name">
               <span th:text="${archivo.name}"></span>.<span th:text="${archivo.extension}"></span>
           </div>
        </div>
    </div>
    </main>
</div>

<script>
    function crearArchivo() {
        window.location.href = '/crear-archivo';
    }

    function crearDirectorio() {
        window.location.href = '/crear-carpeta';
    }

    function subirArchivo() {
        window.location.href = '/subir-archivo';
    }

  function abrirCarpeta(nombre) {
    window.location.href = '/navegar?carpeta=' + encodeURIComponent(nombre);
}

function irAtras() {
    window.location.href = '/volver';
}

    function verArchivo(nombre) {
    console.log("Abriendo archivo:", nombre);
    window.location.href = '/ver?archivo=' + encodeURIComponent(nombre);
}

    function logout() {
        window.location.href = '/logout';
    }

    function cambiarVista(vista) {
        window.location.href = '/' + vista;
    }
</script>

</body>
</html>